Лекция 3
Типы данных

Цель лекции: Ознакомиться с типами данных применяемых в программах на языке C#. Уяснить, как применяются типы данных и для чего они нужны. Разобрать вопрос задания типов данных.
Язык C# является типизированным языком. Каждая переменная и константа имеет тип, как и выражение, результатом вычисления которого является значение.

Тип данных определяет множество значений, которые могут принимать элементы программы. Введение типа дало возможность автоматического поиска ошибок при компиляции, что  приводит к созданию надежных программ.
Тип определяет для элемента программы:
объем памяти для размещения. По типу компилятор определяет размер памяти для размещения значений элемента,
место для хранения переменной типа,
минимальное и максимальное значения, которые могут принимать данные,
разрешенные операции.
Типы могут быть:
стандартные (не требуют объявления),
пользователя (тип пользователя должен быть объявлен дополнительно).
Типы Т1 и Т2 идентичны, если:
имеют один и тот же идентификатор типа,
один объявлен эквивалентным другому (один из них может быть преобразован к другому). Например, целый в вещественный, символьный в строковый.
Система типов языка C# включает следующие категории: 
Типы-значения        // в переменных типа значения хранятся данные
Ссылочные типы   // в переменных хранятся ссылки на фактические данные
Типы указателей  // в переменных хранятся адреса ячеек памяти из диапазона значений и специального значения — нулевого адреса. 
Существует возможность преобразовать тип значения в ссылочный тип и обратно в тип значения с помощью упаковки-преобразования и распаковки-преобразования.

3.1. Типы значений
Переменные, основанные на типах значений, содержат непосредственно значения. При присвоении переменной одного типа значений другому создается копия присваиваемого значения. В этом заключается отличие от переменных ссылочного типа, при присвоении которых копируются ссылки на объекты, но не сами объекты. 
Все типы значений являются неявными производными от System.ValueType . 
Типы значений состоят из двух основных категорий:
Структура struck. Это тип значения, который используется для объявления небольших групп связанных переменных, например координат точки.
Перечисление enum. Оно состоит из набора именованных констант, который называется списком перечислителя. 
По умолчанию первому элементу задан номер 0, а последующие – увеличиваются на 1. Например: enum Days {Sat, Sun, Mon, Tue, Wed, Thu, Fri};
Структуры делятся на следующие категории:
Числовые типы. Они могут быть целочисленные, вещественные – с плавающей запятой, десятичные.
Логический bool. Ключевое слово bool используется при объявлении переменных для хранения логических значений, true и false.
Пользовательские структуры.

3.2. Ссылочные типы
Переменные ссылочных типов, называемые объектами, они сохраняют ссылки на фактические данные. Для объявления ссылочных типов используют ключевые слова:
Класс class. 
Интерфейс interface.
Делегат delegate.
Динамический dynamic.
Объект object.
Строка string.

3.3 Классы
Класс – совокупность объектов с одинаковыми свойствами. Определив класс, его можно использовать, загрузив в память. Класс, загруженный в память, называется объектом или экземпляром класса. Экземпляр класса создается с помощью ключевого слова new. Каждый экземпляр класса занимает отдельную область памяти.
Подобно тому, как на основе одного чертежа можно построить несколько зданий, можно создать любое количество объектов одного класса.  Часто используют массивы или списки, содержащие множество объектов одного класса с независимыми значениями.
Классы объявляются с помощью ключевого слова class. Класс может содержать:
Методы;     // подпрограммы для обработки данных объекта какого-то класса
Свойства;   // характеристики объекта, его параметры
Поля;          // предназначены для хранения информации об объекте
События; // сигналы, формируемые пользователем, ОС, программой 
Делегаты;  // способ передачи метода
Вложенные классы.
Тип object 
Переменным типа object можно назначать значения любых типов. Когда переменная типа значения преобразуется в объект, говорят, что она упаковывается. Когда переменная типа object преобразуется в тип значения, говорят, что она распаковывается.
Тип string
Тип string представляет последовательность из нуля или более символов в кодировке Юникод. Строка C# представляет собой группу одного или нескольких символов, заключенных в двойные кавычки и объявленных с помощью ключевого слова string, 
string Приветствие = "Hello, Friend!";
Строковые объекты являются неизменяемыми, после создания их нельзя изменить. 

3.4. Задание типов в объявлениях переменных
При объявлении переменной или константы в программе необходимо задать ее тип. Синтаксис объявления:
тип Имя = Значение;
Примеры объявления некоторых переменных:
float Вес = 400.2;		 // переменная Вес типа float (с плавающей зпт.)
string Имя = ''ЭтоЯ'' ;	 // переменная Имя типа string
char Буква = 'A';		      // переменная Буква символ
int[ ] Массив = { 0, 1, 2, 3, 4, 5 };	      // переменная Массив целых чисел
После объявления переменной она не может быть повторно объявлена с новым типом, и ей нельзя присвоить значение, несовместимое с ее объявленным типом. 
Например, нельзя объявить переменную типа int и затем присвоить ей логическое значение true. 
Однако значения могут быть преобразованы в другие типы, например, при их присвоении новым переменным или при передаче в качестве аргументов метода. 
Например, число -120 – (тип sbyte) в число -00000000120 – (тип short).
Преобразование типов, которое не приводит к потере данных и автоматически выполняется компилятором, называется неявным. 
Для преобразования, которое может привести к потере данных, необходимо в исходном коде указать тип преобразования. Такое преобразование называется явным. Оно может привести к ошибке.
Например, число 0.8124582613425765 (тип double) в число 0.81245826 (тип float).
C# имеет встроенные типы для представления значений целых чисел, вещественных чисел, логических выражений, текстовых символов, десятичных значений и других данных. 
В приложение Б приведены таблицы с перечислением базовых типов и их краткое описание, типы целых чисел, типы чисел с плавающей запятой и значение типов по умолчанию.

3.5. Преобразования типов
Все вычисления происходят с использованием типа double. Другие типы чисел могут применяться для уменьшения занимаемой памяти. При их использовании перед вычислением они преобразуются в тип double. Различают преобразования:
Неявные преобразования используются для совместимых типов. Значения источника полностью отображаются приемником, т.к. тип приемника больше, чем тип источника. Например, преобразование int в double (int – подмножество double) выполняется автоматически, его не надо заказывать. 
Явные преобразования используются для несовместимых типов. Например, при преобразовании double в int (int – подмножество double) значения источника не полностью отображаются приемником. 
Если типы несовместимы, и ошибка допустима, то преобразование возможно, но его нужно при объявлении явно заказать: перед преобразуемым выражением в круглых скобках добавляется префикс идентификации конечного типа. 
Например, 
double db=12.94;
int i = (int) db;

3.6. Стандартное форматирование чисел
Все числа выводятся в консоль в виде строк символов. Потому перед выводом применяется форматирование результата. 
Все числовые типы поддерживают определенный набор описателей формата. Для чисел поддерживаются национальные стандарты. Например, для России разделитель целой и дробной части числа   запятая.
Метод вывода в консоль содержит в двойных кавычках строку вывода, в состав которой входят выводимые символы и описатели форматов вывода не строковых данных, вставляемые в строку в нужных местах. После строки через запятые перечисляются имена выводимых данных. Количество описателей формата и не строковых данных одинаково, нумерация данных начинается с нуля.
Описатель формата помещается в фигурные скобки и имеет структуру:
"{<Номер позиции вывода>,<Число позиций>:<Буква>d}"
Пример 1. Если указывается только номер позиции вывода, то выводимые не строковые данные форматируются по умолчанию. Строка кода:
Console.WriteLine("p={0}",p);    даст результат        p=2,8322092165912
Пример 2. Выводятся значения x, y (номера позиции вывода 0 и 1), формат по умолчанию.
Console.WriteLine("x = {0} y =  {1}",  x, y);                  x=-2,1548  y=15,125  
Пример 3. Выводится значение x (номер позиции вывода 0), под число отводится 8 позиций, используется денежный формат (буква C).
Console.WriteLine("x = {0,8:C}", x);                                               
Пример 4. Выводится значение y (номер позиции вывода 0), используется общий формат (буква G – реально полученное при вычислении количество символов).
Console.WriteLine("y = {0:G}", y);                                      y=65,1253  
Пример 5. Выводится значение z (номер позиции вывода 0), используется экспоненциальный (научный) формат (буква E – 6 символов после запятой).
Console.WriteLine("z = {0:E}", z);                                      
Пример 6. Выводятся значения x, y (номера позиции вывода 0 и 1), под числа отводится 5 позиций, используется фиксированный формат (буква F – 2 символа после запятой).
Console.WriteLine("y={0,5:f} p={1,5:f}", y, p);             
                                                                                              
Пример 7. Выводится значение s (номер позиции вывода 0) по шаблону. В отображении числа отводится 1 позиция для целой и 3 позиции для дробной части числа.
Console.WriteLine("s= {0:#.###}", s);                            s= 7,825
Имеется набор стандартных форматов. Синтаксис записи формата:
<Буква описания формата>d.
Описатель формата - это алфавитный символ, определяющий строковое представление объекта, к которому он применяется. Также строка формата может содержать необязательный описатель точности d, определяющий, сколько цифр отображается в результирующей строке. Если спецификаторы пропускаются, то используются их значения по умолчанию. Предусмотрены следующие форматы, представленные в таблице 3.1:
Таблица 3.1
Форматы чисел
Описание форматов:
Формат G – общий. Поддерживается всеми числовыми типами данных. Но результат наиболее компактен при использовании экспоненциального формата или формат с фиксированной запятой. Описатель точности - количество значащих цифр. 
Формат F - фиксированная запятая. Результат - цифры целой и дробной частей с необязательным отрицательным знаком. Поддерживается всеми числовыми типами данных. Описатель точности - количество цифр дробной части (по умолчанию 2).
Формат N – число. Результат - цифры целой и дробной частей, разделители групп и разделитель целой и дробной частей с необязательным отрицательным знаком. Поддерживается всеми числовыми типами данных. Описатель точности - желаемое число знаков дробной части.
Формат E – экспоненциальный (научный). Результат – экспоненциальное отображение. Поддерживается всеми числовыми типами данных. Описатель точности - количество цифр дробной части. Описатель точности по умолчанию 6.
Формат D – десятичный. Результат - целочисленные цифры с необязательным отрицательным знаком. Поддерживается только целочисленными типами данных. Описатель точности - минимальное число цифр. Описатель точности по умолчанию - минимальное необходимое число цифр.
Формат C – валюта. Результат – значение валюты. Если есть символ, то он выводится. Поддерживается всеми числовыми типами данных. Описатель точности -  количество цифр дробной части.
Формат P – проценты. Результат – число, умноженное на 100 и отображаемое с символом процента. Поддерживается всеми числовыми типами данных. Описатель точности - желаемое число знаков дробной части.
Символы char
Тип Char – это один символ в коде unicod. Символ помещается в апострофы (одиночные кавычки). Синтаксис объявления:
char Имя = ' Символ ';
char S = ' z ';

3.7. Инструкции, команды, выражения
Код приложений в C# состоит из инструкций (команд) с ключевыми словами и выражениями с операторами.
В инструкцию включают  объявление переменных, присвоение значений, вызов методов, ветвление на один или другой блок кода, в зависимости от заданного условия. Порядок выполнения инструкций в программе называется потоком выполнения. 
Инструкция - строка кода, которая заканчивается точкой с запятой.
Блочная инструкция - набор инструкций в фигурных скобках { }. Может содержать вложенные блоки {  {…}  }. 
Выражение — это строка кода, которая определяет способ вычисления некоторого значения. Выражение состоит из:
Операндов,            // данные, над которыми выполняются действия
Знаков операций,
Круглых скобок    // используются для изменения приоритетности операций.
Выражение включают в состав инструкции. Пример с простым выражением: 
х = 100;      // Данная инструкция выполняет присвоение значения 100 переменной х. 
Инструкцией такого вида можно инициализировать любое число переменных с одним и тем же значением, например 20:
a = b = c = d = e = 20;
В объявлении константы необходимо задать значение.
double Площадь = 0;		// Переменная с инициализацией
double Радиус = 2;
const double pi = 3.14159;  // Константа pi с конечным числом символов.
Инструкция с выражением вычисляет значение выражения, которое сохраняется в указанной переменной. 
Площадь = pi * (Радиус * Радиус);
Разделители
В языке С# как разделители рассматриваются:
пробелы,
знаки табуляции,
переход на новую строку.
В инструкциях языка С# лишние разделители компилятором игнорируются. 
Можно написать: 
myValue=100;   или    myValue  =  100;
Компилятор обработает эти две инструкции как абсолютно идентичные. Исключение состоит в том, что пробелы в пределах строки не игнорируются. В строке кода: 
Console.WriteLine("Я изучаю C# !");   
 // каждый пробел между словами «Я», «изучаю», «C#» и знаком «!» будет обрабатываться, как отдельный символ строки.
Разделители применяются для того, чтобы сделать программу более удобной для программиста, для компилятора разделители абсолютно безразличны.
Разделители в тексте программы позволяют компилятору находить и анализировать ключевые слова языка. 
Математические операции
Для выполнения сложных математических операций, например в тригонометрии, используется класс платформ Math. В приложении В приведены таблицы Класс System.Math поля и методы.
Примеры использования методов Sin (вычисление синуса) и Sqrt (вычисление квадратного корня) и константа PI (системная константа с большим количеством знаков), Pow(возведения в степень), Exp(вычисления экспоненты)
using System;
double d = Math.Sin(Math.PI/2); 

double q = Math.Sqrt(144);                         

double y = (Math.Exp(x)+1)/( Math.Pow(p,1/3) - Math.Abs(Math.Pow(s,3)-1));

              

double t = Math.Pow(2,x)* Math.Cos(b*y) - 
                   Math.Pow(3,y)*Math.Pow(Math.Sin(b*x),2);
            

double n = b*t+a; 
double s = Math.Exp(-b*t)* Math.Sin(n)- 
                                         Math.Sqrt(Math.Abs(n));
Приоритеты операций
1.   Вычисления в ( )       // Сначала вычисления в самых внутренних ()
2.   !	унарные  + / -       // Отрицание операнда и добавление знака +/-
3.   *	 /	                        // Операции типа умножения * / 
4.   +	 		                  // Операции типа сложения  + -  
5.   <  	 >      <=       >=    // Операции типа сравнения, отношения                             
6.   ==     !=	                   // Операции типа сравнения, эквивалентность
7.   &                                 // Операция лог. умножения И
8.   |                                    // Операции лог. сложения  ИЛИ
Краткие итоги. В лекции были рассмотрены типы данных. Как они задаются, какие бывают типы данных. Изучена система типов язык С#, преобразование типов данных из одного в другой и вопросы форматирования.

Контрольные вопросы
Что определяет тип данных?
Что включает в себя система типов данных языка C#?
Из чего состоят типы значений?
Перечислите ссылочные типы и как они задаются.
Приведите примеры задание переменных, что необходимо при этом знать.
Какие преобразования типов вы знаете?
Чем отличается стандартное форматирование от не стандартного?
Дайте определение что такое «выражение».
Для чего применяются разделители?
Что необходимо знать при выполнении математических операций?
Приведите примеры вычисления математических операций.
Как строятся приоритеты операций?