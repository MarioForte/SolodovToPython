Лекция 6
Циклы

Цель лекции. Изучить решение циклической формы с помощью языка C#. Рассмотреть операторы цикла, их назначение и применение. Дать определение цикла.

6.1 Операторы цикла
Алгоритмы решения многих задач являются циклическими, т.е. для достижения результата определенная последовательность действий должна быть выполнена несколько раз. Циклом называется группа инструкций, повторяющихся многократно с разными данными. Например, программа контроля знаний. Для циклов применяются инструкции: goto, for, while, do while.
Инструкция goto
Инструкция goto в первых языках программирования была основой для реализации циклов и многократных переходов, вследствие чего возникала запутанность кода программы. Опытные программисты стараются ее не использовать, но для того, чтобы узнать все возможности языка, рассмотрим и ее.
Инструкция goto используется следующим образом:
В коде программы создается метка с именем (например, M). 
Организуется переход на эту метку инструкцией goto M. 
Имя метки M в коде обязательно должно заканчиваться двоеточием (:). Оно указывает на точку в программе, с которой будет выполняться программа после использования инструкции goto. 
Обычно инструкция goto привязывается к условию. 

Пример 1. Используя цикл (метка M - начало), написать программу, в которой в консоль выводится последовательность чисел.

	public static int Main()
	{ 
			int i = 0; 
		M : Console.WriteLine("i= {0} ", i); 
			i = i + 1; 
			if (i < 10) goto M; 
                Console.ReadKey();
		}
	}


Решение циклических задач можно организовать на основе структуры ветвление или с помощью инструкций циклов.
Пример 2. Вычислить на ЭВМ  значения функций 

при а=1.3,  b=1.29,  t = [ 0.1… 2.2],   t изменяется в диапазоне от 0.1 до 2.2 с шагом h=0.3. 
Организовать вывод значений аргумента и вычисленного значения функции в виде таблицы с заголовком.


static void Main(string[] args)
        {
            double tn = 0.1, tk = 2.2, h = 0.3, t=0.1, x, s;
            const double a = 1.3, b = 1.29;
            Console.WriteLine("Таблица расчета функции s");
            Console.WriteLine();
            t = tn;
            M : x = a * t; 
            if (x < 1) s = x + b;
            else if (x == 1) s = Math.Cos(x);
                 else s=Math.Exp(x)*Math.Cos(x);
            Console.WriteLine(" *********************** ");
            Console.WriteLine(" * x= {0,4} * s= {1,6:f} *",x,s);
            t=t+h;
            if (t<=tk) goto M;           
            Console.WriteLine(" *********************** ");
            Console.ReadKey();
        }




Инструкция for
Служит для организации циклов с заранее известным числом повторений. Циклы, в которых количество повторений заранее определено, называются регулярными. 
В цикле изменение индекса цикла заложено в инструкцию. Задаются - начальное значение индекса (инициализация), условие выполнения, правило изменения индекса после итерации. Разделители для параметров инструкции for – точка с запятой (;).
Формат записи цикла for для повторного использования одной инструкции имеет вид:
for (инициализация; условие выполнения; итерация) инструкция;
Если цикл предназначен для повторного выполнения программного блока, то его формат:
for (индекс цикла = начало; условие выполнения; изменение индекса)
{ 
	Инструкции тела цикла;
}
Существует 2 варианта записи инструкции: инкрементный и декрементный.
Инкрементный вариант:
Программа использует цикл, в котором в консоль выводится последовательность чисел от 0 до 9 (шаг = 1).
static void Main(string[] args)
        {
            for (int i = 0; i < 10; i++)    // шаг = 1
            Console.WriteLine("i = {0} ", i);
            Console.ReadKey();
        }
Декрементный вариант:
Программа использует цикл, в котором в консоль выводится последовательность чисел от 10 до 1 (шаг = -1).
static void Main(string[] args)
        {
            for (int i = 10; i > 0; i)   // шаг = 1
            Console.WriteLine("i = {0} ", i);
            Console.ReadKey();
        }
Выполняется оператор For следующим образом:
Сначала вычисляется и запоминается начальное и конечное значения индекса цикла (индекс – порядкового типа). 
Далее индексу цикла присваивается начальное значение. 
Затем значение индекса цикла сравнивается с конечным значением. 
Далее, пока индекс цикла  конечного значения (в 1 варианте оператора), выполняется очередная итерация цикла, в противном случае – выход из цикла.
При завершении цикла индекс цикла объявляется неопределенным.

Пример 3. Вывести на экран буквы от A  до  Z (инкрементный вариант)
static void Main(string[] args)
{   
            for (char i = 'a'; i <= 'z'; i++)
                Console.Write(" "+ i);
                Console.ReadKey();
        }
Пример 4. Написать программу, которая выводит таблицу квадратов первых десяти целых положительных чисел (инкрементный вариант).


static void Main(string[] args)
{
int x = 1, y = 1;
Console.WriteLine("Таблица квадратов:");
Console.WriteLine();
Console.WriteLine("------------------");
Console.WriteLine("   x    |    y   ");
Console.WriteLine("------------------");
for (byte i = 1; i <= 10; i++)
{
y = x * x;
Console.WriteLine(" x = {0,2} | y = {1,3}", x, y);
x=x+1; 
     }
Console.WriteLine("------------------"); ;
Console.ReadKey();
    }

Пример 5. Обратный отсчет времени перед запуском (декрементный вариант)
static void Main(string[] args)
        {
Console.WriteLine("Обратный отсчет времени:");            
Console.WriteLine();
for (byte second = 10; second >= 1; second--) //отрицательное приращение
            {
Console.Write("Осталось ={0,2} ", second);
Console.WriteLine(" минут"); 
             }
Console.WriteLine();
Console.WriteLine("Старт!"); 
Console.ReadKey();
        }




6.2 Использование нескольких управляющих переменных цикла
Для управления циклом for можно использовать две и больше переменных. В этом случае инструкции инициализации и итерации для каждой из этих переменных отделяются запятыми.

Пример 6. Программа использует цикл, в котором в консоль выводятся последовательности чисел от 0 до 4 (шаг = 1) и от 10 до 6 (шаг = -1).

static void Main(string[] args)
        {
 int i, j;
for (i = 0, j = 10; i < j; i++, j--)
Console.WriteLine(" i и j : " + i + " " + j);
Console.ReadKey();
        }


6.3 Использование переменных цикла c любым шагом их изменения
Пример 7. Используя оператор выбора, вычислить значения функции:
 если x изменяется в интервале  0..10 с шагом dx=1.5



int A;
double x = 0, y, dx = 1.5; ;
M: Console.WriteLine("Введите параметр А ");
A = Convert.ToInt16(Console.ReadLine());
Console.WriteLine(" А=" + A);
Console.WriteLine(" *********************** ");
for (x = 0; x <= 10; x = x + dx)
   {
 switch (A)
   {
case 0: y = Math.Cos(x); break;
   case 1: y = (x - 10) * 8; break;
    case -1: y = A * 7 * x; break;
  default:
  {
Console.WriteLine("A введено не верно!");
goto M;
         }
   }
Console.WriteLine(" * x= {0,4} * y= {1,6:f} *", x, y);
Console.WriteLine(" *********************** ");
            }
Console.ReadKey();

6.4 Цикл с предусловием. Инструкция while . .  
Цикл  с инструкцией while .. используется в том случае, если последовательность действий надо выполнить несколько раз, причем количество повторений заранее не известно и может быть определено, только во время работы программы.
Процессы, в которых количество повторений заранее не определено, называются итерационными. А сами циклы – называются итеративными. 
В этом виде цикла условие стоит перед телом цикла, поэтому этот цикл называют с предусловием. Тело цикла повторяется, пока выполняется условие. Тело цикла первый раз выполняется с проверкой условия. 
Форма цикла while с одиночной инструкцией:
while (Условие) инструкция;
В случае повторного выполнения программного блока
формат цикла выглядит следующим образом:
while (Условие)
{ 
	Инструкции тела цикла;
}



Пример 8. Программа использует цикл, в котором в консоль выводится последовательность чисел от 0 до 9.
static void Main(string[] args)
		{ 
	int i = 0; 
	while (i < 10) 
	{
	Console.WriteLine("i = {0 } ", i); 
	i = i + 1; 
	}
           Console.ReadKey();
		}

Инструкция While выполняется следующим образом:
Сначала вычисляется значение выражения условия.
Если значение выражения условия равно True (истина), то выполняются очередные инструкции тела цикла. После этого снова проверяется выполнение условия. Если условие выполняется, то инструкции цикла выполняются еще раз. И так до тех пор, пока условие не станет ложным (False).
Если значение выражения условия равно False (ложно), то цикл прекращается, выполнение оператора цикла заканчивается и выполняется следующий оператор, предусмотренный программой.
Пример 9. Вычислить наибольшее положительное целое число n, удовлетворяющее условию: 3n5 - 690n  7.

static void Main(string[] args)
        {
int n = 1;
while (3*Math.Pow(n,5)-690*n <= 7)
n = n + 1; 
Console.WriteLine("n = {0 } ", n-1);
Console.ReadKey();
        }

Пример 10. Определить число К натуральных чисел, сумма которых не превышает S.

static void Main(string[] args)
     {
double sum=0, s; int k = 0;
Console.WriteLine("Введите s");
         //ввод данных с клавиатуры
s = Convert.ToDouble(Console.ReadLine());
         /*преобразует вводимое с клавиатуры число 
         в виде строки в вещественный тип данных */
if (s >= 0)
     {
while (sum < s)
         {
k=k+1;
              sum=k*(k+1)/2;
         }
Console.Write("Сумма k = {0}", k);
Console.WriteLine(" натуральных чисел s <= {0}", s);
     }
else Console.WriteLine("Ошибочный ввод данных, s < 0 " );
Console.ReadKey();
   }

6.5 Цикл с постусловием. Инструкция do - while

Цикл  с инструкцией do . . while используется в том случае, если последовательность действий надо выполнить несколько раз, причем количество повторений заранее не известно и может быть  определено во время работы программы. 
Относится к итерационным процессам. 
В этом виде цикла условие стоит после тела цикла, поэтому этот цикл называют с постусловием. Тело цикла повторяется, пока выполняется условие. Тело цикла первый раз выполняется без проверки условия. Выход из цикла при не выполнении условия.
Эта циклическая инструкция работает по принципу: «Повторить — пока выполняется условие». 
Ее синтаксис выглядит следующим образом:

do
{ 
	Инструкции тела цикла;
}
while (Условие);

Пример 11. Программа использует цикл, в котором в консоль выводится последовательность чисел.
static void Main(string[] args)
	{ 
int i = 0; 
do
	{
Console.WriteLine("i = {0} ", i); 
i = i + 1; 
	}
while (i < 10);
Console.ReadKey();
	}
Инструкция do…while выполняется следующим образом:
Сначала выполняются находящиеся между do…while инструкции тела цикла.
Затем вычисляется значение выражения условия. 
Если  значение выражения условия истинно (True), то  инструкции тела цикла выполняются еще раз. 
Если значение выражения условия ложно (False), то выполнение цикла прекращается и выполняется следующий оператор, предусмотренный ходом выполнения программы.
Цикл do…while используется для организации приближенных вычислений с заданной точностью, задач поиска и обработки данных в массиве или в файле.
Пример 12. Вычислить наибольшее положительное целое число n, удовлетворяющее условию: 3n5 - 690n  7.

static void Main(string[] args)
  {
int n = 1;
do n = n + 1;
while (3 * Math.Pow(n, 5) - 690 * n <= 7);
Console.WriteLine("n = {0 } ", n - 1);
Console.ReadKey();
  }




Пример 13. Написать программу, вычисляющую сумму и среднее арифметическое последовательности положительных  чисел, которые вводятся с клавиатуры.

static void Main(string[] args)
        {
int s =  = 0, n = 0; double m;
Console.WriteLine("Введите положительные числа");
Console.WriteLine("Для выхода из цикла введите 0");
do
{
s = s + a;
Console.Write(">> ");
a = Convert.ToInt16(Console.ReadLine());
n = n + 1;
}
while (a > 0);
n = n - 1;
  Console.WriteLine("n = {0} ", n);
Console.WriteLine("s = {0} ", s);
m = s / n;
Console.WriteLine("m = {0,5:f} ", m);
Console.ReadKey();
 }




6.6 Накопление сумм и произведений
Пример 14 . Написать программу вычисляющую сумму и произведение чисел от 1 до 10.

Рассмотрим процесс накопления S суммы и P произведения чисел от 1 до 10.
Накопление суммы                                      Накопление произведения




Блок схема и программа накопления S и P:

static void Main(string[] args)
        {
            int s, p, i;
            s = 0;
            p = 1;
            for (i = 1; i <= 10; i++)
            {
                s = s + i;
                p = p * i;
            }
            Console.WriteLine("Сумма 10 чисел=" + s);
            Console.WriteLine();
            Console.WriteLine("Произведение 10 чисел=" + p);
            Console.ReadKey();
        }


Программные блоки не снижают динамику выполнения программ. Наоборот, их наличие позволяет в одном цикле вычислить как сумму, так и произведение.
Для вывода всех частичных сумм  и произведений их вычисления надо поместить в блок тело цикла.
static void Main(string[] args)
{
  int s, p, i;
  s = 0;
  p = 1;
  for (i = 1; i <= 10; i++)
  {
   s = s + i;
   Console.WriteLine("Сумма "+ i + " чисел=" + s);
   p = p * i;
   Console.WriteLine("Произведение " + i + 
                                                        " чисел=" + p);
   Console.WriteLine();
  }
    Console.ReadKey();
}

Пример 15. Написать программу вычисляющую сумму членов ряда:
 
t=sin(x*1)+ sin(x*2)+ sin(x*3)+ sin(x*4)+ sin(x*5)
t0 = 0
t1 = t0 +  sin(x*1)
t2 = t1 +  sin(x*2)
t3 = t2 +  sin(x*3)
t4 = t3 +  sin(x*4)
t5 = t4 +  sin(x*5)


static void Main(string[] args)
        {
            int n; double x = 0.5, t=0;
            for (n = 1; n <= 5; n++)
               t =t +  Math.Sin(x*n);
            Console.WriteLine("Сумма членов ряда = {0:#.###}", t );    
            Console.ReadKey();
        }
Пример 16. Написать программу вычисляющую произведение членов ряда:
 
v=cos2(x*2) * cos2(x*3) * cos2(x*4) * cos2(x*5) * cos2(x*6)
v0 = 1
v1 = v0  *  cos2(x*2)
v2 = v1  *  cos2(x*3)
v3 = v2  *  cos2(x*4)
v4 = v3  *  cos2(x*5)
v5 = v4  *  cos2(x*6)

static void Main(string[] args)
  {
 int k; double x = 0.5, v=1;
 for (k = 2; k <= 6; k++)
 v = v * Math.Pow(Math.Cos(x*k),2);
 Console.WriteLine("Произведение членов ряда = {0:#.######}", v);    
 Console.ReadKey();
 }



Пример 17. Написать программу вычисляющую функцию 
:

static void Main(string[] args)
{
int a=1,b=1,s=0,w=1;
for (a = 1; a <= 5; a++)
{
  s=0;
for (b = 1; b <= 8; b++)
s = s + a*a * b;
w = w * s;
}
 Console.WriteLine("w = {0}", w);    
Console.ReadKey();
  }



6.7 Безусловные переходы
Бывают ситуации, когда необходимо прекратить выполнение цикла досрочно, опустив выполнение кода, оставшегося в теле цикла и проверку условного выражения. 
С помощью инструкции break можно организовать немедленный выход из цикла.
Пример 18. В консоль выводятся только отрицательные числа в заданном диапазоне
static void Main(string[] args)
        {
            for (int i = -10; i <= 10; i++)
            {
            if (i > 0) break;        //Завершение цикла при i>0
            Console.Write(i + " ");
            }
            Console.WriteLine("Готово!");
            Console.ReadKey();
        }


Несмотря на то, что цикл for спроектирован для перебора значений i в диапазоне от  -10 до 10, инструкция break досрочно прекращает его выполнение, когда значение переменной i становится положительным.
Инструкция continue в отличие от break не прерывает хода выполнения цикла. Она лишь приостанавливает текущую итерацию и переходит к следующей итерации.
Пример. В консоль выводятся нечетные числа в заданном диапазоне. Поверка осуществляется проверкой остатка от деления на 2, для нечетных чисел он равен 1. В цикле перебираются все числа от 1 до 10. Если очередное число четное, то итерация завершается с пропуском последующих инструкций тела цикла и переходом к следующей итерации.

static void Main(string[] args)
	{
	for ( int i = 10; i > 0; i--)
	{ 
	if ( i%2 !=1 ) continue;
	Console.WriteLine("{0} - нечетное число", i);
	Console.WriteLine("Нажмите любую клавишу");
 	Console.ReadKey();
	} 
	} 

Здесь выводятся только нечетные числа, поскольку при обнаружении четного числа происходит преждевременный переход к следующей итерации и метод  WriteLine не вызывается.
 
Инструкция foreach 
Инструкция foreach (для каждого) предназначена для обработки массивов.  Она повторяет группу вложенных в нее инструкций для каждого элемента массива. 
Синтаксис инструкции:
foreach (<ИндексЦикла> in <ИмяМассива>)
{
	Инструкции тела цикла;
}

В любой точке блока foreach цикл можно разорвать с помощью ключевого слова break или перейти к следующей итерации в цикле с помощью ключевого слова continue. 
Цикл foreach также может быть разорван при помощи инструкций goto, return или throw. 

Пример. В консоль выводится содержимого массива целых чисел. 
static void Main(string[] args)
        {
            int[] Massiv = { 0, 1, 2, 3, 5, 8, 13 };   // Определен массив чисел
            foreach (int i in Massiv)
            {
                Console.WriteLine(i);
            }
            Console.ReadKey();
        }

Краткие итоги. В лекции были рассмотрены вопросы построения цикла с помощью инструкций goto, for, while, do-while. Построение программ накопления суммы и произведения. Представлены примеры работы всех перечисленных инструкций.

Контрольные вопросы:
Что называется «циклом»?
Как используется инструкция goto для решения цикла?
Для чего служит инструкция for?
Какие варианты использования инструкции for вы знаете, приведите примеры.
Как используются несколько управляющих переменных цикла, приведите примеры.
Как используются переменные цикла с любым шагом их измерения, приведите примеры.
В каких случаях используется инструкция while, приведите примеры.
Как выполняется инструкция while?
В каких случаях используется инструкция do. . .while, приведите примеры
Как выполняется инструкция …while?
Приведите примеры накопления суммы.
Приведите примеры накопления произведения.
С помощью, каких инструкций организуется безусловный переход, приведете примеры.
Как работает инструкция foreach?