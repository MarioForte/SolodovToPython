Лекция 9
Классы, объекты и методы. Функции в Python

Цель лекции. Изучить классы, объекты и методы, их характеристики, определение, свойства и как они представляются. Рассмотреть функции их преимущества, дать определение.

9.1 Введение в классы, объекты и методы
Программирование в Python построено на классах. У класса две различные роли:
модуля и 
типа данных.

Класс – это некий шаблон (модуль), который определяет форму объекта. Или множество объектов, связанных общностью структуры и поведения. Класс определяет, как должен быть построен объект. Однотипные объекты могут объединяться в классы (группы).
Конкретный объект, имеющий структуру этого класса, называется экземпляром класса. 
Например, объект кнопка button1 – это экземпляр класса кнопок Button. Сам класс определяется общими свойствами, которые имеют все экземпляры этого класса.

Модульность построения – основное свойство программных систем. Система, построенная по модульному принципу, состоит из классов, являющихся основным видов модуля. Можно построить монолитную систему, состоящую из одного модуля, решающая ту же задачу, что и система, состоящая из нескольких простых модулей. Большую систему, создаваемую коллективом разработчиков, без разделения системы на модули построить не удается. Поэтому модульность построения – основное средство борьбы со сложностью системы.

Класс – это особый тип записи, имеющий в своем составе атрибуты (поля) и методы обработки. Каждый модуль имеет содержательную начинку. Класс становится модулем и имеет определенное назначение. В основе класса лежит абстрактный тип данных.

Атрибуты класса служат для хранения информации об объекте. В Python атрибуты могут быть как обычными переменными, так и свойствами (properties), которые обеспечивают контролируемый доступ к данным.

Методами называются функции, предназначенные для обработки внутренних данных объекта данного класса (атрибутов). Объект может обладать набором заранее встроенных методов обработки, созданных пользователем, которые выполняются при наступлении заранее определенных событий, например: нажатие кнопки мыши, определенной клавиши, выбор пункта меню и т.п..

Свойства – характеристики объекта, его параметры. Объект представляется с помощью присущих ему свойств.
Например:
   ОБЪЕКТ_1 (свойство-1, свойство-2, . . . свойство-k).
Свойства объектов различных классов могут пересекаться. Например:
   ОБЪЕКТ_А (. . свойство-n, свойство-m, . . . свойство-k).
   ОБЪЕКТ_B (свойство-1,. . . свойство-n, . . . свойство-k).

9.2 Синтаксис класса
class ИмяКласса:
    def __init__(self, параметры):  # Конструктор
        # объявление атрибутов экземпляра
        self.атрибут1 = значение1
        self.атрибут2 = значение2
        # ... ... ... ... 
        self.атрибутN = значениеN
    
    def метод1(self, параметры):  # объявление методов
        # тело метода1
        pass
    
    def метод2(self, параметры):
        # тело метода2
        pass
    # ... ... ... ...
    def методN(self, параметры):
        # тело методаN
        pass

В Python нет явных спецификаторов доступа как в C#. По соглашению:
- атрибуты и методы, начинающиеся с одного подчеркивания (_), считаются внутренними
- атрибуты и методы, начинающиеся с двух подчеркиваний (__), считаются приватными
- все остальные атрибуты и методы являются публичными

Правильно определенный класс должен содержать логически связанные данные.
Все переменные, объявленные на уровне класса, являются атрибутами класса.
Атрибуты задают представления абстракции данных, которую реализует класс.
Атрибуты характеризуют свойства объектов класса.
Описаниями класса являются объявления атрибутов и методов.
Метод представляет собой функцию, являющуюся элементом класса. Методы выполняют действия над объектами класса. Все объекты одного класса имеют один и тот же набор методов.

9.3. Основные понятия функции
Функция – логически законченная часть программы, которую по имени можно вызывать в разные места программы неограниченное число раз. 
Она решает часть общей задачи. У нее есть имя, которое используется при вызове функции в основную программу.

В Python все подпрограммы являются функциями. Функция может:
- возвращать значение с помощью оператора return
- не возвращать значение (возвращает None)
- возвращать несколько значений (в виде кортежа)

Функция отличается от процедуры двумя особенностями:
всегда может вычислять некоторое значение, возвращаемое в качестве результата функции, 
функция может вызываться в выражениях.

В Python функция может быть реализована как:
- функция, возвращающая значение
- функция, не возвращающая значение (аналог процедуры)

Программа без структурных элементов называется монолитной. Минимальный элемент такой программы – оператор (инструкция). Она сложна в разработке, отладке и сопровождении.
Структурированная программа называется модульной. Она содержит более крупные компоненты – функции. Модульная программа проще создается, более понятна.
Программа на языке Python строится из модулей, роль которых играют классы и функции, но каждый из этих модулей имеет содержательную начинку.
Функции могут быть связаны с классом (методы), они обеспечивают требуемую функциональность класса и называются методами класса. Также функции могут существовать независимо от класса.

Синтаксис объявления функции позволяет однозначно определить, что является функцией.
Работа с функцией включает 2 этапа:
описание функции;
вызов функции.

Преимущества функции:
1. в программе нет дублирования кода;
2. повышается надежность программы;
3. улучшается «читаемость» программы;
4. облегчается процесс отладки.

Различают функции:
без параметров (), 
с параметрами (params).

9.4 Сравнение вариантов
Рассмотрим 2 варианта решения одной и той же задачи: 
Вывод текстовых блоков со вставкой стандартного разделителя из трех строк из набора символов " * " в конце.

1-й вариант (Монолитная программа)
def main():
    print("Текст и разделители")
    print()
    print("Текст 1")  # Вывод 1 текста
    for i in range(3):
        for j in range(20):
            print("*", end="")
        print()  # Вывод строк разделителя
    print()
    print("Текст 2")  # Вывод 2 текста
    for i in range(3):
        for j in range(20):
            print("*", end="")
        print()  # Вывод строк разделителя
    print()
    print("Текст 3")  # Вывод 3 текста
    for i in range(3):
        for j in range(20):
            print("*", end="")
        print()  # Вывод строк разделителя
    input()

if __name__ == "__main__":
    main()

2-й вариант (Модульная программа)
def draw_str():  # Функция "Рисовать строки" без параметров
    for i in range(3):
        for j in range(20):
            print("*", end="")
        print()  # Вывод строк разделителя

def main():
    print("Текст и разделители")
    print()
    print("Текст 1")  # Вывод 1 текста
    draw_str()  # Вызов функции "Рисовать строки"
    print()
    print("Текст 2")  # Вывод 2 текста
    draw_str()  # Вызов функции "Рисовать строки"
    print()
    print("Текст 3")  # Вывод 3 текста
    draw_str()  # Вызов функции "Рисовать строки"
    input()

if __name__ == "__main__":
    main()

9.5 Описание функций
Синтаксически в описании функции различают две части:
Описание заголовка
Описание тела функции.

ЗАГОЛОВОК_ФУНКЦИИ
ТЕЛО_ФУНКЦИИ

Синтаксис заголовка функции:
def имя_функции([список параметров]):

имя_функции ([список параметров]) составляют сигнатуру функции
– обязательная часть в заголовке функции.

Примеры описания функций:
def A():  # функция без параметров
    pass

def B():  # функция, возвращающая целое значение
    return 0

def C(x, y):  # функция с параметрами
    return x + y

def _private_method():  # внутренний метод (начинается с _)
    pass

def __private_method():  # приватный метод (начинается с __)
    pass

9.6 Аргументы и параметры
Параметры – данные, с которыми работает функция. Это внутренние данные для функции и перечисляются в ее заголовке. Список может содержать фиксированное число аргументов, разделяемых запятой – для функции с параметрами или быть пустым – для функции без параметров.

Синтаксис объявления параметров:
def функция(параметр1, параметр2, *args, **kwargs):
    pass

Например: (p1, p2, *args, **kwargs)

Параметры связаны с аргументами.
Аргументы – данные, передаваемые в функцию или возвращаемые из нее. Это внешние для функции данные, с которыми имеет дело вызывающая часть программы. В функции им соответствуют параметры. Указываются в списке аргументов при обращении к функции и являются фактическими параметрами.

Синонимы:
Параметры = формальные параметры, условно Р.
Аргументы = фактические аргументы, условно А.

Можно для фиксированного числа формальных параметров передать функции произвольное число фактических аргументов. Для этого в списке формальных параметров необходимо задать *args для позиционных аргументов и **kwargs для именованных аргументов.

Для аргументов и параметров надо соблюдать:
одинаковое количество (An=Pn) для обязательных параметров,
совместимость типов (типы одинаковы или неявно преобразованные).

Все формальные параметры разделяются на группы: 
позиционные параметры – передают информацию функции и их значения в теле функции только читаются;
именованные параметры – имеют значения по умолчанию, могут быть переданы при вызове или использованы по умолчанию;
*args – собирает дополнительные позиционные аргументы в кортеж;
**kwargs – собирает дополнительные именованные аргументы в словарь.

Например:
# Функция с различными типами параметров
def example_function(p1, p2=10, *args, **kwargs):
    print(f"p1: {p1}")
    print(f"p2: {p2}")
    print(f"args: {args}")
    print(f"kwargs: {kwargs}")

# Вызов функции
example_function(1, 2, 3, 4, 5, name="John", age=25)

Области действия имен
Структура функции идентична структуре программы.
Имена, объявленные в главной программе являются глобальными. Они доступны во всех внутренних точках, в том числе и в функциях.
Имена, объявленные в функции, являются локальными. Они доступны во всех внутренних точках функции.
Локальное имя во внешней программе недоступно. Память под них выделяется автоматически в момент вызова функции.
Если используются одинаковые локальное и глобальное имя, то внутри функции локальное имя блокирует глобальное.

9.7 Тело функции
Синтаксически тело функции является блоком, который представляет собой последовательность инструкций и описание переменных с отступом. 
В теле функции в блоке может быть оператор, возвращающий значение функции в формате
return выражение

Переменные, описанные в блоке, считаются локальными в этом блоке.

Вызов функции. Синтаксис.
Функция может быть вызвана в выражении или как оператор тела блока. Сам вызов функции имеет один и тот же синтаксис:
имя_функции([список фактических аргументов])

В момент вызова функции происходит:
1. вычисление фактических аргументов, которые являются выражением,
2. в точке вызова создается блок, в котором происходит замена имен параметров фактическими аргументами.

Функция
Пример 1. Написать функцию, проверяющую, является ли целое число, введенное с клавиатуры четным. Программа должна использовать эту функцию, проверять является ли число четным или нет, и выводить соответствующее сообщение.

def chet(n):  # Функция "Четность"
    if n % 2 == 0:
        return True
    else:
        return False

def main():
    print("Определение четности аргумента")
    print()
    while True:
        m = int(input("m >> "))
        if chet(m):
            print("Число четное")
        else:
            print("Число нечетное")
        print()
        if m == 0:
            break
    input()

if __name__ == "__main__":
    main()

Функция (аналог процедуры)
Пример 2. Вывести таблицу квадратных корней.
Для оформления таблицы использовать функцию Line.

import math

def line(n, c):  # Функция "Рисовать линию" с параметрами n и c
    for k in range(n):
        print(c, end="")
    print()  # Вывод строки с символами c

def main():
    m = 18
    print("Таблица квадратных корней")
    print()
    line(m, '=')  # Вызов функции "Рисовать линию"
    print(" Число | Корень")
    line(m, '=')  # Вызов функции "Рисовать линию"
    for i in range(10):
        q = math.sqrt(i)
        print(f"   {i}   |   {q:3.3f}")
        line(m, '-')  # Вызов функции "Рисовать линию"
    input()

if __name__ == "__main__":
    main()

9.8 Классы в Python - примеры

Пример 3. Простой класс для работы с прямоугольником:

class Rectangle:
    def __init__(self, width, height):
        self.width = width
        self.height = height
    
    def area(self):
        return self.width * self.height
    
    def perimeter(self):
        return 2 * (self.width + self.height)
    
    def __str__(self):
        return f"Прямоугольник {self.width}x{self.height}"

# Использование класса
rect = Rectangle(5, 3)
print(rect)
print(f"Площадь: {rect.area()}")
print(f"Периметр: {rect.perimeter()}")

Пример 4. Класс с приватными атрибутами и свойствами:

class BankAccount:
    def __init__(self, initial_balance=0):
        self.__balance = initial_balance  # приватный атрибут
    
    @property
    def balance(self):  # свойство для чтения баланса
        return self.__balance
    
    def deposit(self, amount):
        if amount > 0:
            self.__balance += amount
            return True
        return False
    
    def withdraw(self, amount):
        if 0 < amount <= self.__balance:
            self.__balance -= amount
            return True
        return False

# Использование класса
account = BankAccount(1000)
print(f"Баланс: {account.balance}")
account.deposit(500)
print(f"Баланс после пополнения: {account.balance}")
account.withdraw(200)
print(f"Баланс после снятия: {account.balance}")

Краткие итоги. В лекции были даны определения, что такое классы, объекты, методы в Python. Представлен синтаксис класса, методы представления функций. Изучены функции, относящиеся к подпрограмме, дано их описание. Рассмотрены особенности Python в работе с классами и функциями.

Контрольные вопросы.
Дайте определение понятию «класс» в Python.
Что лежит в основе класса?
Каковы свойства и характеристики объекта?
Как работают модификаторы доступа в Python?
Дайте определение понятию «функция» в Python.
Назовите преимущества функции.
Сравните монолитную и модульную программы, назовите их различия.
Опишите методы функций.
Дайте определение что такое «параметры» и «аргументы».
Каковы области действия имен в Python?
Опишите процедуру вызова функции.
Приведите пример работы функции.
Приведите пример работы класса.
Что такое self в Python?
Как работают свойства (properties) в Python?
